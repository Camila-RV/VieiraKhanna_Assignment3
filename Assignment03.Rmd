---
title: "MPP-E1180: Collaborative Social Data Analysis Assignment 3"
author: "Camila Vieira & Tarun Khanna"
date: "11 November 2016"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
pkgs <- c('dplyr', 'ggplot2')
```

# Collected Indicators and Hypotheses

##Source 1: World Bank - World Development Indicators 

*GDP per capita (constant 2000 US$)*

Definition: Gross domestic product divided by midyear population.
Hypothesis: Economic growth and income have an important and positive impact on green investment.  They generate a higher demand for energy and clean air. /// as well as higher economic means for adopting new technologies - However, this interpretation is based on GDP only, right?////

  
*Energy imports, net (% of energy use)*

Definition: Net energy imports are estimated as energy use less production, both measured in oil equivalents. Energy use refers to use of primary energy before transformation to other end-use fuels, which is equal to indigenous production plus imports and stock changes, minus exports and fuels supplied to ships and aircraft engaged in international transport.

Hypothesis: The energy imports indicator may allows us to verify whether countries have reduced dependence on energy sources from other countries by investing in renewable installations.
We expect that a lower energy imports value increases the likelihood of countries investing in the installation of renewable energy sources. /// If a country presents a negative value it indicates that the country is a net exporter. ->> How to address this point? ///

*Fossil fuel energy consumption (% of total*

Definition: Use of energy from fossil fuel as a percent of total energy use. Fossil fuel comprises coal, oil, petroleum, and natural gas products.

Hypothesis: The greater the percentage of energy consumption is the lower will be the incentives for developing installation capacity of renewable energy sources through new investments.

##Source 2: Eurostat

*Innovation in Renewable Energy*

Definition: Number of patents filed for renewable energy/climate mitigation country wise. It comprises energy technologies patent applications submitted to the European Patent Office.
Hypothesis: The number of patent applications in renewable energy is used as a proxy for innovation levels having a positive impact on investments in renewable resources. 

*Long-term interest rate (10 ys. maturity)*

Definition: Interest rates affect the capital available for investment. Changes in interest rates may impact costs related to access to finance as well as the return on investments. As the realisation of investments especially those related to infrastructure occurs in the long-run, a ten-year maturity interest rate is used in this analysis.  
The indicator chosen for this study is the Maastricht criterion bond yields which is used as a convergence criterion for EMU for long-term interest rates (central government bond yields on the secondary market, gross of tax, with around 10 years' residual maturity).

Hypothesis:  Higher interest rates imply that business will have less incentives to invest in renewable sources whereas lower interest rates foster long-term investments. In addition, higher interest rates may also increase the costs associated with the generation of electricity from renewable energy sources. 

*Electricity from renewable energy sources*

Definition: Electricity generated from renewable energy sources is measured as the percent of gross electricity consumption in the EU-28 countries. It stands for the the ratio between the electricity produced from renewable energy sources and the gross national electricity consumption within a given year. 
This is the variable over which we build our study on green investments. Electricity generation from wind and solar power energy sources is used as a proxy for renewable energy investments and we expect to verify the effects of the factors presented in this section onto green investments. 

##Source 3: OPEC

*Crude oil prices*

Definition: Crude oil prices represent annual averages of selected OPEC crude oils (OPEC basket).
The benchmark for crude oil price is the OPEC Reference Basket. This basket represents the average of prices of petroleum blends produced by OPEC members. Some of these oil blends include, for example, the Saharan Blend from Algeria, Arab Light from Saudi Arabia, BCF 17 from Venezuela, et cetera. OPEC tries to keep the price between given maxima and minima by increasing and decreasing its oil production. 

Hypothesis: Crude oil prices can be used as proxy for the demand of energy from fossil fuels. One can assume that a higher demand for fossil fuel is negatively correlated with investments in renewable energy sources and changes in prices may reveal trends in energy production and consumption. In this sense, we hypothesize that a higher price in crude oil means higher demand, or at least, scarcer availiability of fossil fuels, and therefore, it may have a negative effect in investments in renewable energy sources. 


# Statistical Analysis





















































```{r cars}
knitr::opts_chunk$set(echo = TRUE)

setwd("~/Desktop/CollaborativeDataMethods/VieiraKhanna_Assignment3/data_cleaning")
source('Eurostat_and_Opec_data.R')
source('WDI_data.R')
re_data <- merge(Combined_WDI,Combine_EuroStat,by = c("country", "year"), all.x = T, all.y = T)
re_data1 <- na.omit(re_data)


```


```{r pressure, echo=FALSE}

# Data visualisation

library(ggplot2)

#selecting data
re_data1 <- re_data1[order(re_data1$year,re_data1$re_gen),] #arranging data
countries10 <- tail(re_data1,10)[1] %>% as.matrix() %>% as.character() %>% paste(collapse = "|") #finding top10
re_data_top10  <- filter(re_data, grepl(countries10, country)) #selecting top 10 countries by generation 

#create graph of RE Generation
Colours <- c('#543005','#8c510a','#bf812d','#dfc27d','#f6e8c3','#c7eae5','#80cdc1',
             '#35978f','#01665e','#003c30') # assigning colour pallette

ggplot(data = na.omit(re_data_top10)) + 
  aes(x = year, y = wind_gen, group = country, fill = country) +
  geom_area(position = "stack") + 
  scale_color_manual(values = Colours) +
  xlab("\nYear") +
  ylab("Wind Energy Generation(TWh)\n") +
  ggtitle("Wind Energy Generation in ten largest wind energy markets in Europe\n") +
  theme_bw()

ggplot(data = na.omit(re_data_top10)) + 
  aes(x = year, y = solar_gen, group = country, fill = country) +
  geom_area(position = "stack") + 
  scale_color_manual(values = Colours) +
  xlab("\nYear") +
  ylab("Solar Energy Generation(TWh)\n") +
  ggtitle("Solar Energy Generation in ten largest wind energy markets in Europe\n") +
  theme_bw()

# create GDP_indicator
#p <- summary(re_data1$GDP_capita) %>% as.matrix(.) %>% as.character() %>% paste(collapse = ",")
summary(re_data$GDP_capita)
re_data1$GDP_ind <- cut(re_data1$GDP_capita, c(5544, 13800, 30780, 45730, 110000), labels = c("<13k", "13k-30k", "30k-45k", "45k-110k"))

# create graph
Colours <- c("#1B9E77", "#D95F02", "#7570B3",
             "#E7298A", "#66A61E", "#E6AB02")
ggplot(data = re_data1,
                    aes(GDP_capita,re_gen)) +
        geom_jitter(aes(colour = GDP_ind)) +
        scale_color_manual(values = Colours) +
        xlab("\nGDP per capita") +
        ylab("RE Generation\n") +
        ggtitle("Renewable Energy generation by income group\n") +
        theme_bw()



```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
